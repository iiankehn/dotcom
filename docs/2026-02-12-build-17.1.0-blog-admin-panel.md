## Build 17.1.0 – Blog admin panel

- **Date**: 2026-02-12
- **Area**: Admin tools (`/admin`, `blog/posts.js`)

### Summary

- **Added a local admin panel** for managing blog posts without editing JS or HTML files directly.
- **Hooked the admin backend into the existing posts data file** (`blog/posts.js`) so the public site continues to read from the same source.

### Details

- **Updated**: `blog/posts.js`
  - Wrapped the posts array in a `const BLOG_POSTS = [...]` declaration.
  - Exposes the data both:
    - To the browser: `window.BLOG_POSTS = BLOG_POSTS` (unchanged behavior for the public site).
    - To Node: `module.exports = BLOG_POSTS` (for the admin backend).

- **New file**: `package.json`
  - Adds a minimal Node project definition with:
    - Dependency: `express`.
    - Script: `"admin": "node admin/server.js"` to run the admin server.

- **New directory**: `admin/`
  - **`admin/server.js`**
    - Express-based local backend for managing posts.
    - Serves the static admin UI from `admin/`.
    - Reads posts via `require('../blog/posts.js')`.
    - Writes changes back to `blog/posts.js` by regenerating the file contents:
      - Serializes the posts array to JSON.
      - Wraps it as:
        - `const BLOG_POSTS = <data>;`
        - `window.BLOG_POSTS = BLOG_POSTS;`
        - `module.exports = BLOG_POSTS;`
    - API endpoints:
      - `GET /api/posts` – list all posts.
      - `GET /api/posts/:slug` – fetch a single post.
      - `POST /api/posts` – create a new post.
      - `PUT /api/posts/:slug` – update an existing post.
      - `DELETE /api/posts/:slug` – delete a post.

  - **`admin/index.html`**
    - Tailwind-styled admin UI.
    - Layout:
      - Left column: table of posts (title, slug, published label, archive flag).
      - Right column: editor form for the selected post or a new post.
    - Uses the same visual language (Inter/JetBrains Mono, dark theme) as the main site.

  - **`admin/admin.js`**
    - Frontend logic for the admin UI.
    - Responsibilities:
      - Fetch posts from `/api/posts` and render the table.
      - Populate the editor form when a row is clicked.
      - Map form fields to the post shape used in `BLOG_POSTS`:
        - `slug`, `title`, `publishedOn`, `publishedLabel`, `hasArchive`, `archivePath`, `indexHtml`, `articleHtml`.
      - Handle:
        - Create (POST `/api/posts`).
        - Update (PUT `/api/posts/:slug`).
        - Slug rename (delete old, create new).
        - Delete (DELETE `/api/posts/:slug`).
      - Display lightweight status messages in the UI.

### How to use the admin panel

1. **Install dependencies (once)**:
   - Run `npm install` in the project root (same folder as `package.json`).

2. **Start the admin server**:
   - Run `npm run admin`.
   - Open `http://localhost:3000` in your browser.

3. **Manage posts**:
   - Use the **Posts** table to select an existing post.
   - Use the **Editor** form to change title, dates, HTML content, etc.
   - Click **Save** to persist changes; `blog/posts.js` will be regenerated.
   - Use **New Post** to create a new entry.
   - Use **Delete** (with confirmation) to remove a post.

4. **Deploying changes**:
   - After editing posts via the admin panel, commit and push the updated `blog/posts.js` (and any new archive HTML files you create) as part of your normal deployment process.

